# build like:
#   singularity build --fakeroot JABS-GUI.sif behavior-classifier-vm-gui.def

Bootstrap: docker
From: python:3.8.6-buster

%files
    .. /behavior-classifier

%runscript
    exec python /behavior-classifier/app.py "$@"

%post
    pip install -r /behavior-classifier/requirements.txt
    # GUI libraries
    apt-get update && apt-get install -y qt5-default libglu1-mesa-dev libgl1-mesa-glx libxcb-util0 libvtk6-dev alsa-utils
    # Very unsafe symlink, but python is expecting v1 but ubuntu provides v0.0.0.
    ln -s /usr/lib/x86_64-linux-gnu/libxcb-util.so.0.0.0 /usr/lib/x86_64-linux-gnu/libxcb-util.so.1

